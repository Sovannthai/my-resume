import{P as g,c as L}from"./index-BkGG_BzC.js";import{d,z as v,f as i,o as c,w as f,p,u as l,L as S,j as B,c as $,l as M,n as R,K as b,k as z,E as I,G as x,y as j,m as A}from"./app-DmflEHlh.js";import{a as C,i as k}from"./useForwardExpose-DmO7knOg.js";import{c as F}from"./RovingFocusGroup-VQgSexTf.js";const[E,P]=F("AvatarRoot"),T=d({__name:"AvatarRoot",props:{asChild:{type:Boolean},as:{default:"span"}},setup(e){return C(),P({imageLoadingStatus:v("idle")}),(a,s)=>(c(),i(l(g),{"as-child":a.asChild,as:a.as},{default:f(()=>[p(a.$slots,"default")]),_:3},8,["as-child","as"]))}}),q=d({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{default:"span"}},setup(e){const a=e,s=E();C();const r=v(a.delayMs===void 0);return S(o=>{if(a.delayMs&&k){const n=window.setTimeout(()=>{r.value=!0},a.delayMs);o(()=>{window.clearTimeout(n)})}}),(o,n)=>r.value&&l(s).imageLoadingStatus.value!=="loaded"?(c(),i(l(g),{key:0,"as-child":o.asChild,as:o.as},{default:f(()=>[p(o.$slots,"default")]),_:3},8,["as-child","as"])):B("",!0)}});function w(e,a){return e?a?(e.src!==a&&(e.src=a),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function D(e,{referrerPolicy:a,crossOrigin:s}={}){const r=v(!1),o=v(null),n=$(()=>r.value?(!o.value&&k&&(o.value=new window.Image),o.value):null),m=v(w(n.value,e.value)),_=u=>()=>{r.value&&(m.value=u)};return M(()=>{r.value=!0,S(u=>{const t=n.value;if(!t)return;m.value=w(t,e.value);const h=_("loaded"),y=_("error");t.addEventListener("load",h),t.addEventListener("error",y),a!=null&&a.value&&(t.referrerPolicy=a.value),typeof(s==null?void 0:s.value)=="string"&&(t.crossOrigin=s.value),u(()=>{t.removeEventListener("load",h),t.removeEventListener("error",y)})})}),R(()=>{r.value=!1}),m}const G=d({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{default:"img"}},emits:["loadingStatusChange"],setup(e,{emit:a}){const s=e,r=a,{src:o,referrerPolicy:n,crossOrigin:m}=b(s);C();const _=E(),u=D(o,{referrerPolicy:n,crossOrigin:m});return z(u,t=>{r("loadingStatusChange",t),t!=="idle"&&(_.imageLoadingStatus.value=t)},{immediate:!0}),(t,h)=>I((c(),i(l(g),{role:"img","as-child":t.asChild,as:t.as,src:l(o),"referrer-policy":l(n)},{default:f(()=>[p(t.$slots,"default")]),_:3},8,["as-child","as","src","referrer-policy"])),[[x,l(u)==="loaded"]])}}),H=d({__name:"Avatar",props:{class:{}},setup(e){const a=e;return(s,r)=>(c(),i(l(T),{"data-slot":"avatar",class:j(l(L)("relative flex size-8 shrink-0 overflow-hidden rounded-full",a.class))},{default:f(()=>[p(s.$slots,"default")]),_:3},8,["class"]))}}),J=d({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{},class:{}},setup(e){const a=e,s=$(()=>{const{class:r,...o}=a;return o});return(r,o)=>(c(),i(l(q),A({"data-slot":"avatar-fallback"},s.value,{class:l(L)("bg-muted flex size-full items-center justify-center rounded-full",a.class)}),{default:f(()=>[p(r.$slots,"default")]),_:3},16,["class"]))}}),Q=d({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(e){const a=e;return(s,r)=>(c(),i(l(G),A({"data-slot":"avatar-image"},a,{class:"aspect-square size-full"}),{default:f(()=>[p(s.$slots,"default")]),_:3},16))}});export{H as _,Q as a,J as b};
